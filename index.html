<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>疲労感VAS</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 1em;
    }

    .container {
      max-width: 400px;
      margin: auto;
    }

    .vas-scale {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .vas-label {
      width: 80px;
      text-align: center;
      font-size: 0.9em;
    }

    input[type="range"] {
      flex: 1;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>疲労感VAS評価フォーム</h2>

    <label for="subjectId">被験者ID：</label><br>
    <input type="text" id="subjectId" name="subjectId" readonly><br><br>

    <label for="vas">現在のあなたの状態について、感覚的にあてはまるところにスライダーを左右に動かしてください。位置が決まったら送信して下さい。</label>
    <div class="vas-scale">
      <span class="vas-label left">疲れを全く感じない「最良」の感覚</span>
      <input type="range" id="vas" name="vas" min="0" max="100" value="50">
      <span class="vas-label right">何もできないほどの疲労を感じる「最悪」の状態</span>
    </div>

    <br>
    <button onclick="submitForm()">送信</button>
  </div>

 <script>
  // URLパラメータからID取得
  const params = new URLSearchParams(window.location.search);
  const id = params.get('id');
  document.getElementById('subjectId').value = id || '';

  function submitForm() {
    const subjectId = document.getElementById('subjectId').value;
    const vasValue = document.getElementById('vas').value;

    alert(`ID: ${subjectId}`);

    fetch('https://script.google.com/macros/s/AKfycbwFlYFLIJY4IDRg45Uk7tiH4W4PyxxSC15_cScleZ9RvvJDezIvqlPG3BDxL2kMDVwO2w/exec', {
      method: 'POST',
      body: new URLSearchParams({
        'subjectId': subjectId,
        'vasValue': vasValue
      })
    })
    .then(response => response.text())
    .then(result => {
      alert('送信成功、ウインドウを閉じます: ' + result);
      window.close(); // ウインドウを閉じる
    })
    .catch(error => {
      alert('送信失敗: ' + error);
    });
  }
</script>



</body>
</html>





